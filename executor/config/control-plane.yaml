# HFI 控制平面配置文件

server:
  # HTTP 服务器配置
  host: "0.0.0.0"
  port: 8080
  read_timeout: "30s"
  write_timeout: "30s"
  idle_timeout: "120s"

# 日志配置
logging:
  level: "debug"        # debug, info, warn, error
  format: "json"        # json, text
  output: "stdout"      # stdout, stderr, file path

# 存储配置
storage:
  # 支持的类型: memory, etcd
  type: "etcd"
  
  # 内存存储配置 (开发环境)
  memory:
    max_policies: 1000
    cleanup_interval: "5m"
  
  # etcd 存储配置 (生产环境)
  etcd:
    endpoints:
      - "etcd:2379"
    timeout: "5s"
    dial_timeout: "10s"
    username: ""
    password: ""
    # TLS 配置 (可选)
    tls:
      enabled: false
      cert_file: ""
      key_file: ""
      ca_file: ""
      insecure_skip_verify: false

# API 配置
api:
  # 启用的 API 版本
  versions: ["v1"]
  
  # 请求限制
  rate_limit:
    enabled: true
    requests_per_second: 100
    burst: 200
  
  # CORS 配置
  cors:
    enabled: true
    allowed_origins: ["*"]
    allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allowed_headers: ["*"]
    max_age: "86400"

# 监控配置
monitoring:
  # 健康检查
  health_check:
    enabled: true
    path: "/v1/health"
  
  # Prometheus 指标
  metrics:
    enabled: true
    path: "/v1/metrics"
    
  # 分布式追踪
  tracing:
    enabled: false
    jaeger_endpoint: ""
    sampling_rate: 0.1

# 安全配置
security:
  # 认证 (可选)
  auth:
    enabled: false
    type: "jwt"  # jwt, api_key
    jwt_secret: ""
    api_keys: []
  
  # 授权 (可选)
  rbac:
    enabled: false
    config_file: ""

# 故障注入配置
fault_injection:
  # 策略生效时间
  policy_ttl: "24h"
  
  # 最大并发策略数
  max_concurrent_policies: 100
  
  # 默认配置值
  defaults:
    delay:
      max_duration: "10s"
      min_duration: "1ms"
    abort:
      max_percentage: 100
      allowed_status_codes: [400, 401, 403, 404, 500, 502, 503, 504]
    rate_limit:
      max_rate: 10000
      min_rate: 1

# 开发模式配置
development:
  # 开发模式 (启用更详细的日志和调试功能)
  enabled: true
  
  # 允许不安全的操作
  allow_insecure: true
  
  # 自动重载配置
  auto_reload: true
  
  # 调试端点
  debug_endpoints:
    enabled: true
    pprof: true
    expvar: true
